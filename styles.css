:root{
    --bg:#f7f8fa; --panel:#fff; --border:#d9dee6; --text:#222; --muted:#6b7280;
    --accent:#2563eb; --danger:#ef4444;
    --dot:#aeb7c9;
    --power:#6b7280; --video:#2563eb; --data:#059669;
    --grid1:#dbe2ee; --grid2:#c5cedf; /* grid colors */
  }
  
  *{box-sizing:border-box}
  html,body{height:100%}
  
  body{
    margin:0;
    background:var(--bg);
    color:var(--text);
    font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial;
    overflow:hidden;
  }
  
  .app{
    display:grid;
    grid-template-rows:48px 1fr;
    grid-template-columns:260px 1fr 300px;
    grid-template-areas:
      "toolbar toolbar toolbar"
      "toolbox canvas inspector";
    height:100%;
    position:relative;
  }
  
  /* toolbar */
  .toolbar{
    grid-area:toolbar; display:flex; gap:8px; align-items:center;
    padding:8px 12px; background:var(--panel); border-bottom:1px solid var(--border);
    position:relative; z-index:1000; /* keep on top */
  }
  .toolbar button,.toolbar .btn-like{
    border:1px solid var(--border); background:#fff; padding:6px 10px;
    border-radius:8px; cursor:pointer; font-weight:600; color:#1f2937; display:inline-flex; align-items:center;
  }
  .toolbar button:hover,.toolbar .btn-like:hover{border-color:#c8cfd9}
  .toolbar .spacer{margin-left:auto;color:var(--muted);font-size:12px}
  
  /* left toolbox */
  .toolbox{grid-area:toolbox;background:var(--panel);border-right:1px solid var(--border);padding:10px;overflow:auto}
  .toolbox h3{margin:6px 0 8px;font-size:14px;color:var(--muted)}
  .tool-item{
    display:grid; grid-template-columns:28px 1fr; align-items:center; column-gap:8px;
    padding:8px; margin-bottom:8px; background:#fff; border:1px solid var(--border);
    border-radius:10px; cursor:grab; user-select:none;
  }
  .tool-icon{width:24px;height:24px}
  
  /* right inspector */
  .inspector{grid-area:inspector;background:var(--panel);border-left:1px solid var(--border);padding:12px;overflow:auto}
  .inspector h3{margin:6px 0 10px;font-size:14px;color:var(--muted)}
  .prop{display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-bottom:8px}
  .prop label{font-size:12px;color:var(--muted);align-self:center}
  .prop input,.prop select{padding:6px 8px;border:1px solid var(--border);border-radius:6px;font-size:14px}
  .prop input[type="color"]{padding:0;height:32px}
  
  /* canvas area */
  .canvas-wrap{grid-area:canvas;position:relative;overflow:hidden;background:#fafbfe; z-index:0}
  #grid-canvas{
    position:absolute; inset:0; pointer-events:none; opacity:.85; z-index:0; /* grid behind nodes */
  }
  svg#stage{
    position:relative; z-index:1; width:100%; height:100%; display:block; background:transparent; /* nodes above grid */
  }
  
  /* hints & modals */
  .hint{
    position:absolute; bottom:10px; left:50%; transform:translateX(-50%);
    background:rgba(255,255,255,.98); border:1px solid var(--border); padding:6px 10px; border-radius:8px;
    font-size:12px; color:#374151; z-index:15;
  }
  .help-btn{position:absolute;top:10px;right:10px;z-index:10}
  .help-btn button{border:1px solid var(--border);background:#fff;border-radius:999px;width:36px;height:36px;font-weight:800;cursor:pointer}
  .modal-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center;z-index:20}
  .modal{background:#fff;border-radius:12px;border:1px solid var(--border);width:min(760px,90vw);max-height:80vh;overflow:auto;padding:16px}
  .modal h3{margin-top:0}
  
  /* node look */
  .node{filter:drop-shadow(0 1px 0 rgba(0,0,0,.05))}
  .node rect.body{fill:#fff;stroke:var(--border);stroke-width:1;rx:10;ry:10}
  .node.selected rect.body{stroke:var(--accent);stroke-width:2}
  .node .title-bg{fill:#ffffff;opacity:1}
  .node .title{font-size:13px;fill:#111827;font-weight:600;letter-spacing:.2px}
  .node .pic{opacity:.9}
  
  /* cables */
  .cable{fill:none;stroke-width:3;cursor:pointer;stroke-linecap:round}
  .cable.selected{stroke-width:5;filter:drop-shadow(0 0 2px rgba(0,0,0,.2))}
  .cable.power{stroke:var(--power)}
  .cable.video{stroke:var(--video)}
  .cable.data{stroke:var(--data)}
  
  /* UE-like clickable ports */
  .port{pointer-events:all;cursor:pointer}
  .port .ring{fill:none;stroke-width:4}
  .port .core{fill:#fff;stroke:#111827;stroke-width:1}
  .port[data-type="power"] .ring{stroke:var(--power)}
  .port[data-type="video"] .ring{stroke:var(--video)}
  .port[data-type="data"]  .ring{stroke:var(--data)}
  .port.compat .ring{filter:drop-shadow(0 0 4px rgba(37,99,235,.6))}
  .port:hover .core{transform:scale(1.12);transform-origin:center}
  /* Only the actual stroke should catch clicks (not a big invisible box) */
#cables { pointer-events: visibleStroke; }

/* Temp preview should never block clicks */
#drag-ghosts { pointer-events: none; }

/* (optional) make straight lines chunkier */
.cable { stroke-width: 4; }
.watermark {
    position: fixed;
    bottom: 10px;
    right: 10px;
    font-family: 'Inter', sans-serif;
    font-size: 14px;
    font-weight: 600;
    color: rgba(0, 0, 0, 0.4); /* slightly transparent */
    pointer-events: none; /* donâ€™t block clicks */
    z-index: 9999;
  }
  